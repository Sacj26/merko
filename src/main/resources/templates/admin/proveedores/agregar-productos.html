<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{shared/layouts/admin}"
      lang="es">
<head>
    <title>Agregar Productos</title>
    <link rel="stylesheet" th:href="@{/css/pages/proveedores.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>
<body>
<div layout:fragment="content">
    <div class="header-with-actions">
        <div class="title-group">
            <h1 class="page-title">Agregar Productos a <span th:text="${proveedor.nombre}">Proveedor</span></h1>
            <p class="page-subtitle">Agrega uno o más productos al proveedor</p>
        </div>
    </div>

    

    <div class="form-container">
    <form th:action="@{/admin/proveedores/agregar-productos/{id}(id=${proveedor.id})}" 
          method="post" enctype="multipart/form-data" class="form-admin">
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

        <!-- Sección: Productos -->
        <fieldset class="form-section">
                <legend>
                <i class="fas fa-box"></i> Productos
                <button type="button" class="btn-add-producto btn-icon-only" onclick="agregarProducto()" title="Agregar producto" aria-label="Agregar producto" style="width:40px;height:40px;display:inline-flex;align-items:center;justify-content:center;padding:0;margin-left:8px;">
                    <i class="fas fa-plus-circle" style="font-size:1.1rem"></i>
                </button>
            </legend>

            <div id="productos-container">
                <div class="producto-item" data-producto-index="0">
                    <div class="producto-header">
                        <h4>Producto #1</h4>
                        <button type="button" class="btn-remove-producto" onclick="eliminarProducto(0)" title="Eliminar producto" aria-label="Eliminar producto">
                            <i class="fas fa-trash-alt" aria-hidden="true"></i>
                        </button>
                    </div>
                    <div th:replace="~{shared/fragments/product-form-fields :: indexed('productos[0]')}"></div>
                </div>
            </div>
        </fieldset>

        <!-- Botones -->
        <div class="form-actions">
            <button type="submit" class="btn btn-primary btn-icon-only" title="Guardar productos" aria-label="Guardar productos" style="width:40px;height:40px;display:inline-flex;align-items:center;justify-content:center;padding:0;">
                <i class="fas fa-save" style="font-size:1.1rem"></i>
            </button>
            <a th:href="@{/admin/proveedores}" class="btn btn-secondary btn-icon-only" title="Cancelar" aria-label="Cancelar" style="width:40px;height:40px;display:inline-flex;align-items:center;justify-content:center;padding:0;margin-left:8px;">
                <i class="fas fa-times-circle" style="font-size:1.1rem"></i>
            </a>
        </div>

        <!-- Mensaje de error -->
        <div th:if="${error}" class="alert alert-error">
            <span class="alert-icon"><i class="fas fa-exclamation-circle"></i></span>
            <div class="alert-content">
                <p class="alert-message" th:text="${error}">Error</p>
            </div>
        </div>

    </form>
    </div>
    </div>
</div>

<div layout:fragment="scripts">
    <script th:src="@{/js/pages/proveedores/agregar-productos.js}"></script>
</div>
</body>
</html>
