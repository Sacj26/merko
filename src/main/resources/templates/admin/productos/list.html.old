<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <title>Productos | Merko</title>
    <link rel="stylesheet" th:href="@{/css/admin.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
</head>
<body>

<header class="topbar">
    <div class="logo">Merko Admin</div>
    <nav>
        <form id="logoutForm" action="/logout" method="post" style="display:none;">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        </form>
        <a href="#" class="btn-logout"
           onclick="event.preventDefault(); document.getElementById('logoutForm').submit();">
            <i class="fas fa-sign-out-alt"></i> Salir
        </a>
    </nav>
</header>


<aside class="sidebar">
    <ul>
        <li><a href="/admin"><i class="fas fa-tachometer-alt"></i> Inicio</a></li>
        <li><a href="/admin/productos"><i class="fas fa-box"></i> Productos</a></li>
        <li><a href="/ventas"><i class="fas fa-shopping-cart"></i> Ventas</a></li>
        <li><a href="/ventas/nueva"><i class="fas fa-cart-plus"></i> Registrar Venta</a></li>
        <li><a href="/admin/compras/nueva"><i class="fas fa-truck"></i> Comprar Productos</a></li>
        <li><a href="/admin/proveedores/nuevo"><i class="fas fa-user-plus"></i> Registrar Proveedor</a></li>
        <li><a href="/admin/proveedores/nuevoo"><i class="fas fa-plus-square"></i> Producto a Proveedor</a></li>

    </ul>
</aside>

<main class="content">
    <h1>Productos Disponibles</h1>

    <!-- Tabla de Productos -->
    <table style="width:100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden;">
        <thead style="background: var(--color-primario); color: white;">
        <tr>
            <th style="padding: 10px;">Nombre</th>
            <th style="padding: 10px;">Descripción</th>
            <th style="padding: 10px;">Precio</th>
            <th style="padding: 10px;">Stock</th>
            <th style="padding: 10px;">Acciones</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="producto : ${productos}" style="text-align: center;">
            <td th:text="${producto.nombre}" style="padding: 10px;"></td>
            <td th:text="${producto.descripcion}" style="padding: 10px;"></td>
            <td th:text="${producto.precioVenta}" style="padding: 10px;"></td>
            <td th:text="${producto.stock}" style="padding: 10px;"></td>
            <td style="padding: 10px;">
                <a th:href="@{'/admin/productos/editar/' + ${producto.id}}" class="btn-logout" style="background-color: #f39c12; margin-right: 5px;">Editar</a>
                <form th:action="@{'/admin/productos/eliminar/' + ${producto.id}}" method="post" style="display:inline;">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                    <button type="submit" class="btn-logout" style="background-color: #c0392b;"
                            onclick="return confirm('¿Estás seguro de eliminar este producto?')">Eliminar</button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>

    <h2 style="margin-top: 40px;">Historial de Compras a Proveedores</h2>

    <table style="width:100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden; margin-top: 10px;">
        <thead style="background: #2980b9; color: white;">
        <tr>
            <th style="padding: 10px;">Fecha</th>
            <th style="padding: 10px;">Proveedor</th>
            <th style="padding: 10px;">Producto</th>
            <th style="padding: 10px;">Cantidad</th>
            <th style="padding: 10px;">Precio Unidad</th> <!-- Nueva columna -->
            <th style="padding: 10px;">Total Pagado</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="compra : ${compras}" style="text-align: center;">
            <td th:text="${compra.fecha}" style="padding: 10px;"></td>
            <td th:text="${compra.proveedor.nombre}" style="padding: 10px;"></td>
            <td th:text="${compra.producto.nombre}" style="padding: 10px;"></td>
            <td th:text="${compra.cantidad}" style="padding: 10px;"></td>
            <td th:text="${compra.precioUnidad}" style="padding: 10px;"></td> <!-- Mostrar precio unidad -->
            <td th:text="${compra.total}" style="padding: 10px;"></td>
        </tr>
        </tbody>
    </table>
</main>

</body>
</html>
